@{
    ViewBag.Title = "SubGrid";
}
<script type="text/javascript">
$(function () {
    //配置jqGrid
    $("#grid").jqGrid({
        url: "/Home/GetSearchData",
        datatype: "json",
        mtype: "get",
        colModel: [
            { label: 'Number', name: 'No', index: 'No', width: 60, sorttype: "int" },
            { label: 'Name', name: 'Name', index: 'Name', width: 90 },
            { label: 'Email', name: 'Email', index: 'Email', width: 100, sortable: false },
            { label: 'Age',name:'Age',index:'Age'},
            {
                label: 'Birthday', name: 'Birthday', index: 'Birthday', width: 100,
                formatter: 'date', formatoptions: { srcformat: 'Y-m-d', newformat: 'Y-m-d' },
                editable: true, editrules: { required: true }
            },
            {
                label: 'Created On', name: 'CreatedOn', index: 'CreatedOn', width: 150,
                formatter: 'date', formatoptions: { srcformat: 'Y-m-d H:i:s', newformat: 'Y-m-d H:i:s' }
            }
        ],
        caption: "jqGrid Multiple Search",
        loadonce: false,    //排序翻页等操作在服务端完成
        rowNum: 5,
        rowList: [5, 10, 20],  //设置分页下拉列表
        pager: "#pager",
        viewrecords: true,
        width: 500, height: "auto",
        jsonReader: { repeatitems: false },
        sortorder: "asc",
        sortname: "No",//传递给服务端的排序字段名
        subGrid: true,//开启子表格--------------------------------------------------------------------------------
        subGridRowExpanded: function(subgrid_id, row_id) {  // (2)子表格容器的id和需要展开子表格的行id，将传入此事件函数  
            var subgrid_table_id;  
            subgrid_table_id = subgrid_id + "_t";   // (3)根据subgrid_id定义对应的子表格的table的id  
              
            var subgrid_pager_id;  
            subgrid_pager_id = subgrid_id + "_pgr"  // (4)根据subgrid_id定义对应的子表格的pager的id  
              
            // (5)动态添加子报表的table和pager  
            $("#" + subgrid_id).html("<table id='"+subgrid_table_id+"' class='scroll'></table><div id='"+subgrid_pager_id+"' class='scroll'></div>");  
              
            // (6)创建jqGrid对象  
            $("#" + subgrid_table_id).jqGrid({  
                url: "/Home/GetSubGridData?Members.No=" + row_id,  // (7)子表格数据对应的url，注意传入的contact.id参数  
                //url: "/Home/GetSubGridData",  // (7)子表格数据对应的url，注意传入的contact.id参数  
                datatype: "json",  
                colNames: ['编号', 'Message', 'CreatedOn', 'Members_No'],
                colModel: [  
                    {name:"No",index:"No",width:80,key:true},  
                    { name: "Message", index: "Message", width: 130 },
                    { name: "CreatedOn", index: "CreatedOn", width: 80, align: "right" },
                    { name: "Members.No", index: "Members.No", width: 80, align: "right" }
                ],  
                jsonReader: {   // (8)针对子表格的jsonReader设置   
                    repeatitems : false  
                },  
                pager: subgrid_pager_id,  
                viewrecords: true,  
                height: "100%",  
                rowNum: 5,
                sortorder: "asc",
                sortname: "No",//传递给服务端的排序字段名
            });  
        }  
    });  
});
</script>

<h2>SubGrid</h2>

<table id="grid"></table>
<div id="pager"></div>

